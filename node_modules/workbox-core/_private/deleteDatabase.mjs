/*
  Copyright 2018 Google LLC

  Use of this source code is governed by an MIT-style
  license that can be found in the LICENSE file or at
  https://opensource.org/licenses/MIT.
*/

import '../_version.mjs';


/**
 * Deletes the database.
 * Note: this is exported separately from the DBWrapper module because most
 * usages of IndexedDB in workbox dont need deleting, and this way it can be
 * reused in tests to delete databases without creating DBWrapper instances.
 *
 * @param {string} name The database name.
 * @private
 */
export const deleteDatabase = async (name) => {
  await new Promise((resolve, reject) => {
    const self = indexedDB.deleteDatabase(name);
    self.onerror = ({target}) => {
      reject(target.error);
    };
    self.onblocked = () => {
      reject(new Error('Delete blocked'));
    };
    self.onsuccess = () => {
      resolve();
    };
  });
};
